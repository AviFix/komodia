<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>SSL Digestor - Komodia</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.4" />
<link rel="shortcut icon" href="../../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="Komodia (en)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php@action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Komodia Atom feed" href="../index.php@title=Special%253ARecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="../load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;%252A.css" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: komod_wikidb:resourceloader:filter:minify-css:7:dffa96a73b1be9b0dae7e17005fcc939 */</style>

<script src="../load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"SSL_Digestor","wgTitle":"SSL Digestor","wgCurRevisionId":1386,"wgArticleId":57,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"SSL_Digestor","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: komod_wikidb:resourceloader:filter:minify-js:7:c89fc005766e312c555f83b307d08d63 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-SSL_Digestor skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">SSL Digestor</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From Komodia</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="SSL_Digestor.html#column-one">navigation</a>, <a href="SSL_Digestor.html#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="SSL_Digestor.html#What_is_the_SSL_Digestor"><span class="tocnumber">1</span> <span class="toctext">What is the SSL Digestor</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="SSL_Digestor.html#Applications_supported"><span class="tocnumber">2</span> <span class="toctext">Applications supported</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="SSL_Digestor.html#Applications_not_in_the_list"><span class="tocnumber">3</span> <span class="toctext">Applications not in the list</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="SSL_Digestor.html#How_does_it_work.3F"><span class="tocnumber">4</span> <span class="toctext">How does it work?</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="SSL_Digestor.html#CA_Store"><span class="tocnumber">5</span> <span class="toctext">CA Store</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="SSL_Digestor.html#Cert_creation"><span class="tocnumber">6</span> <span class="toctext">Cert creation</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="SSL_Digestor.html#Cert_validation"><span class="tocnumber">7</span> <span class="toctext">Cert validation</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="SSL_Digestor.html#Limitations"><span class="tocnumber">8</span> <span class="toctext">Limitations</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="SSL_Digestor.html#Cert_checking"><span class="tocnumber">8.1</span> <span class="toctext">Cert checking</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="SSL_Digestor.html#Non_HTTPS_SSL"><span class="tocnumber">8.2</span> <span class="toctext">Non HTTPS SSL</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="SSL_Digestor.html#Client_side_certificate"><span class="tocnumber">8.3</span> <span class="toctext">Client side certificate</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="SSL_Digestor.html#Combining_SSL_Digestor_with_existing_solutions"><span class="tocnumber">9</span> <span class="toctext">Combining SSL Digestor with existing solutions</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="SSL_Digestor.html#SSL_decryption_via_proxy"><span class="tocnumber">10</span> <span class="toctext">SSL decryption via proxy</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="SSL_Digestor.html#Alternative_methods"><span class="tocnumber">11</span> <span class="toctext">Alternative methods</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="SSL_Digestor.html#TLS_SNI"><span class="tocnumber">11.1</span> <span class="toctext">TLS SNI</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="What_is_the_SSL_Digestor"> What is the SSL Digestor </span></h1>
<p>The SSL Digestor is a module that is layered on top <a href="Komodia's_Redirector.html" title="Komodia's Redirector">Komodia's Redirector</a> and allows the programmer a transparent access to the decrypted SSL data, this is without raising an alert from the brower.
</p>
<h1> <span class="mw-headline" id="Applications_supported"> Applications supported </span></h1>
<ul><li> The SSL Digestor supports the following browsers:
</li></ul>
<ul><li><ul><li> Internet Explorer
</li><li> Safari
</li><li> Chrome
</li><li> Firefox
</li><li> Opera
</li></ul>
</li></ul>
<ul><li> Chat software:
</li></ul>
<ul><li><ul><li> The module supports Gmail and Facebook chat decoding.
</li></ul>
</li></ul>
<ul><li> The SSL Digestor supports the following SSL enabled email clients:
</li></ul>
<ul><li><ul><li> Outlook
</li><li> Outlook express
</li><li> Winmail
</li><li> Forte agent
</li><li> Becky! internet mail
</li><li> Mailwasher
</li><li> Pocomail
</li><li> Poppeeper
</li></ul>
</li></ul>
<ul><li> The SSL Digestor supports the following SSL enabled applications:
</li></ul>
<ul><li><ul><li> iTunes
</li></ul>
</li></ul>
<ul><li> The SSL Digestor does not support the following SSL decrypting resisting applications:
</li></ul>
<ul><li><ul><li> Dropbox
</li><li> Google drive
</li><li> Logmein
</li><li> AIM
</li></ul>
</li></ul>
<h1> <span class="mw-headline" id="Applications_not_in_the_list"> Applications not in the list </span></h1>
<p>The module may work with unlisted applications that use either the Windows or NSS certificate stores, but that's not officially supported.
</p>
<h1> <span class="mw-headline" id="How_does_it_work.3F"> How does it work? </span></h1>
<p>The SSL Digestor is a modified <a class="external text" href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man In The Middle attack</a>, what it does is "talk" with the application on one side, and talking with the target server on the other, and the Redirector being the man in the middle, just as someone who gets a secret whispered in each ear, normally the browser/app would raise an alert because of the modified certificate, but the <a href="Komodia's_Redirector.html" title="Komodia's Redirector">Komodia's Redirector</a> installs a root CA certificate in advance which means the browser will not send an alert because the certificate created is legit from SSL point of view.
</p>
<h1> <span class="mw-headline" id="CA_Store"> CA Store </span></h1>
<p>A root certificate is installed in a certificate store, currently there are three supported store:
</p>
<ul><li> Windows which affects: Internet Explorer, Chrome, Safari/iTunes (Apple software require an extra step to make it work), Outlook, Outlook express and Winmail.
</li><li> NSS which affects: Firefox and Thunderbird.
</li><li> Opera
</li></ul>
<p>Applications that manages their own store or applications that tries to verify the certificate will raise an alert when the certificate is replaced and will not work with the SSL Digestor (for example Dropbox)
</p>
<h1> <span class="mw-headline" id="Cert_creation"> Cert creation </span></h1>
<p>The SSL Digestor tries to copy the certificate as best as possible, one field it can't copy is the generating entity which will be the company name the module is branded to, it will also copy fields that may cause the certificate verification to fail, because if the original site's certificate would fail, the module wants the same affect so it will not cause a security problem. Also the module tries to verify that the certificate is indeed signed by an approved signer, it will use the CA store of the browser used to verify that (for Internet Explorer the Windows store will be used, and for Firefox the NSS store will be used), if the certificate isn't legit, the created certificate will be created in a way it would raise an alert to protect the user.
</p>
<h1> <span class="mw-headline" id="Cert_validation"> Cert validation </span></h1>
<p>When you receive the cert from the remote server the SDK will validate the cert with the store of the browser that created the connection, also in Windows 7 IE/Chrome the SDK will try to download root and intermediate certs in real time in order to validate the end cert.
</p>
<h1> <span class="mw-headline" id="Limitations"> Limitations </span></h1>
<h2> <span class="mw-headline" id="Cert_checking"> Cert checking </span></h2>
<p>Some applications are actively checking that they receive a certificate they expected to receive (they compare it with a binary copy inside the executable) and you will not be able to decrypt their data, those applications should be SSL excluded (known resisting applications are excluded by default), for example: Dropbox, Logmein ActiveX, also officially only the five browsers are supported.
</p>
<h2> <span class="mw-headline" id="Non_HTTPS_SSL"> Non HTTPS SSL </span></h2>
<p>SSL/TLS can be used in protocols that are not HTTPS, for example SMTPS and FTPS, which start the secure handshake after they send plaintext, the SSL digestor only supports SSL/TLS decrypting when it start at the first data transfer (such as HTTPS).
</p>
<h2> <span class="mw-headline" id="Client_side_certificate"> Client side certificate </span></h2>
<p>The SDK can't work with sites that require client side cert, what the SDK does is when a site requests client cert, the SDK excludes the entire domain, then the browser can "speak" with the site directly.
</p>
<h1> <span class="mw-headline" id="Combining_SSL_Digestor_with_existing_solutions"> Combining SSL Digestor with existing solutions </span></h1>
<p>Some clients have existing solutions that does not support SSL decrypting and want to use Komodia's module, these are the options to do the upgrade:
</p>
<ul><li> Upgrade the entire product and use Komodia's SDK for both HTTP and HTTPS.
</li><li> Use Komodia's SDK just for port 443, and keep using the existing solution for all other ports, also the existing component must know how to co exist with Komodia's filtering components such as LSP or WFP, because some solutions are written (on purpose or because of bugs) to not work with other solutions.
</li></ul>
<h1> <span class="mw-headline" id="SSL_decryption_via_proxy"> SSL decryption via proxy </span></h1>
<p>Some of Komodia's clients requested to have the ability to receive the decrypted inside their proxy so there's an optional module that does that. How it works:
</p>
<ul><li> A connection is made to the Redirector, the SDK checks if it has the certificate for this IP/Port.
</li><li> If it does, it uses the one in cache, if not, it creates a direct connection (not via the proxy) just to get the certificate, once it gets it, it disconnects the session.
</li><li> The Redirector is using the cache it has to communicate with the browser, and it sends the decrypted data to the socks5 proxy of the client.
</li><li> The client's socks5 proxy uses regular SSL when it outputs the data to the original server (the proxy has to encrypt the outbound data)
</li></ul>
<h1> <span class="mw-headline" id="Alternative_methods"> Alternative methods </span></h1>
<p>It's possible to use detour like functionality to intercept the SSL stream before it's encoded and after it's decrypted but there are limitations to this method:
</p>
<ol><li> MS Detours costs 10,000$ at the day of writing this post.
</li><li> Opera will be almost impossible to detour as it's statically linked with a SSL library.
</li><li> DLL injection is required (if not using LSP), which will cause alerts from AV software.
</li></ol>
<p>The <a class="external text" href="../../index.php@page=sniffer.htm">Komodia's SSL Sniffer</a> is based upon detouring technique (using Komodia's proprietary code detour library), but we discontinued this technology.
</p>
<h2> <span class="mw-headline" id="TLS_SNI"> TLS SNI </span></h2>
<p><a class="external text" href="http://en.wikipedia.org/wiki/Server_Name_Indication">TLS SNI</a> is used by the browser (when using TLS) to tell the server the name of the host it wants to use, this is needed for multi homed SSL sites.
</p><p>Pros:
</p>
<ul><li> No need to decrypt traffic.
</li></ul>
<p>Cons:
</p>
<ul><li> Doesn't work with IE/Chrome on Windows XP.
</li><li> May not work with ActiveX or Java.
</li><li> Can only get the host and not the full URL.
</li><li> You can't modify the data, just block the connection.
</li><li> Data remains encrypted, this method is used only to extract the host.
</li></ul>

<!-- 
NewPP limit report
Preprocessor visited node count: 78/1000000
Preprocessor generated node count: 0/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key komod_wikidb:pcache:idhash:57-0!*!0!!en!*!* and timestamp 20150219050324 -->
</div><div class="printfooter">
Retrieved from "<a href="../index.php@title=SSL_Digestor&amp;oldid=1386.html">http://www.komodia.com/wiki/index.php?title=SSL_Digestor&amp;oldid=1386</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="SSL_Digestor.html" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.komodia.com/wiki/index.php?title=Talk:SSL_Digestor&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="../index.php@title=SSL_Digestor&amp;action=edit.html" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="../index.php@title=SSL_Digestor&amp;action=history.html" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="../index.php@title=Special%253AUserLogin&amp;returnto=SSL+Digestor.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="Main_Page.html" style="background-image: url(http://www.komodia.com/images/logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-Official-homepage"><a href="../../index.php.html">Official homepage</a></li>
				<li id="n-recentchanges"><a href="Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.komodia.com/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Komodia [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="Special%253AWhatLinksHere/SSL_Digestor.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="Special%253ARecentChangesLinked/SSL_Digestor.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="../index.php@title=SSL_Digestor&amp;printable=yes.html" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
				<li id="t-permalink"><a href="../index.php@title=SSL_Digestor&amp;oldid=1386.html" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 6 December 2014, at 16:53.</li>
		<li id="viewcount">This page has been accessed 15,342 times.</li>
		<li id="privacy"><a href="Komodia%253APrivacy_policy.html" title="Komodia:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="Komodia%253AAbout.html" title="Komodia:About">About Komodia</a></li>
		<li id="disclaimer"><a href="Komodia%253AGeneral_disclaimer.html" title="Komodia:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6898822-1");
pageTracker._trackPageview();
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.komodia.com/" : "http://piwik.komodia.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 6);
piwikTracker.setDocumentTitle("");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://piwik.komodia.com/piwik.php?idsite=6" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.176 secs. --></body></html>