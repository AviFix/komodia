<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>View source for Komodia's Redirector Compile Insturctions - Komodia</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.4" />
<link rel="next" href="index.php/Komodia's_Redirector_Compile_Insturctions.html" />
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Komodia (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api.php@action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Komodia Atom feed" href="index.php@title=Special%253ARecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;%252A.css" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: komod_wikidb:resourceloader:filter:minify-css:7:dffa96a73b1be9b0dae7e17005fcc939 */</style>

<script src="load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Komodia\'s_Redirector_Compile_Insturctions","wgTitle":"Komodia\'s Redirector Compile Insturctions","wgCurRevisionId":1273,"wgArticleId":41,"wgIsArticle":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Komodia\'s_Redirector_Compile_Insturctions","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: komod_wikidb:resourceloader:filter:minify-js:7:c89fc005766e312c555f83b307d08d63 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Komodia_s_Redirector_Compile_Insturctions skin-monobook action-edit">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">View source for Komodia's Redirector Compile Insturctions</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From Komodia</div>
		<div id="contentSub">‚Üê <a href="index.php/Komodia's_Redirector_Compile_Insturctions.html" title="Komodia's Redirector Compile Insturctions">Komodia's Redirector Compile Insturctions</a></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php@title=Komodia%2527s_Redirector_Compile_Insturctions&amp;action=edit.html#column-one">navigation</a>, <a href="index.php@title=Komodia%2527s_Redirector_Compile_Insturctions&amp;action=edit.html#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text"><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="http://www.komodia.com/wiki/index.php?title=Komodia:Users&amp;action=edit&amp;redlink=1" class="new" title="Komodia:Users (page does not exist)">Users</a>.
</p>
</div>
<hr />
<p>You can view and copy the source of this page:
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">= VS6 environment =

When compiling with VS6 you need to make sure that:

# XPSP2 SDK is installed and configured as the first dirs on the: Executable, Library, Include
# One time change to the file "xstring" under: C:\Program files\Microsoft Visual Studio\VC98\Include, you need to search for 255 and change it to 0, this will change the std::string to be multithreaded compatible, if this change is not made, the binary produced will detect it and will refuse to run.

= Komodia's Redirector =

The project is located under: PCProxy - Redirect.

To compile it you need to open the project: VS6 - PCProxy.dsw, for VS2003 and above: PCProxy.sln and build debug or release according to your needs.

All the names and compile time settings (which affect all components) are located at the file: KomodiaProduct.h

= LSP component =

There are two LSP components:

* LSP\NonIFSLSP, This is the regular LSP used for the Redirector.
* LSP\NonIFSLSP - DNS, This is the LSP used for the DNS Hijack module.

To compile the LSP (either one of them) you need to open the project: VS6 - NonIFSLSP.dsw, for VS2003 and above: NonIFSLSP.sln and build debug or release according to your needs.

= RegisterLSP component =

The component is located under: LSP\RegisterLSP.

To compile it you need to open the project: VS6 - RegisterLSP.dsw, for VS2003 and above: RegisterLSP.sln and build debug or release according to your needs.

= RegisterLSP DLL component =

This component is the DLL form of the RegisterLSP which you might prefer to use over the EXE version.

The component is located under: LSP\InstallDLL.

To compile it you need to open the project: VS6 - InstallDLL.dsw, for VS2003 and above: InstallDLL.sln and build debug or release according to your needs.

= 64bit compilation =

== For code sent before 15th September 2010 or for VS6 and VS2005 ==

# For 64bit you need to compile only the LSP and RegisterLSP modules, first you must have [http://www.microsoft.com/downloads/details.aspx?familyid=e15438ac-60be-41bd-aa14-7f1e0f19ca0d&amp;displaylang=en Microsoft Platform SDK Windows 2003R2] (it may work with newer version, it is tested to work with this version), make sure that you install all.
# Open Build Environemt by going to: Start -> Programs -> Microsoft Platform SDK for Windows Server 2003 R2 -> Open Build Environment Window -> Windows XP 64-bit Build Environment -> Set Windows XP x64 Build Environment (Retail)
# Run your development IDE:
## VS6: "C:\Program files\Microsoft Visual Studio\Common\MSDev98\Bin\MSDEV.EXE" /useenv
## VS2005: "C:\Program files\Microsoft Visual Studio 8\Common7\IDE\devenv.exe" /useenv
## VS2008: "C:\Program files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe" /useenv
# compile Debug64 or Release64 builds, according to your needs.

== For code sent after 15th September 2010 and with VS2008 and above ==

# For 64bit you need to compile only the LSP and RegisterLSP modules.
# Compile the LSP and RegisterLSP with Release64\x64 project type.

= Replacing/Creating a new root CA for the cert installer =

== KomodiaProduct.h ==

* Make sure that inside the KomodiaProduct.h you have the #define SSL_SUBST uncommented.
* #define CERT_INSTALLER_NAME is the define that sets the DLL cert installer DLL name.
* You need to replace the code inside GetSSLSubstPrivateKey and GetSSLSubstPublicKey to hold the values of your cert.

== Creating the root CA ==

The root CA is generated with OpenSSL.exe using the following syntax:

&lt;pre>
openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days 1825 -config ./openssl.cnf
&lt;/pre>

The console app will request some information from you, you can get the password from us, the rest of the data is up to you to decide on.

The output is two files: cakey.pem which is the private key and cacert.pem which is the public key.

== Converting the key ==

You can convert it yourself or use an application you can get from us which translates it into the format just like inside KomodiaProduct.h

= How to integrate with the code =

You have three methods to integrate with the SDK to receive and control the traffic:

# Directly into the source code (only if you have the source code version), all changes goes into the class CClientCustomizations (it's similar to the DLL interface), you also need to uncomment this line: #define SERVICE_CUSTOM_EXTENSIONS inside KomodiaProduct.h, you can see the interface definition here: [[Komodia's Redirector DLL framework guide]].
# Write a DLL using the DLL framework, you can see the interface definition here: [[Komodia's Redirector DLL framework guide]].
# Use the COM framework to interface from your process to the SDK, you can see the interface definition here: [[Komodia's Redirector COM framework guide]].

= Special compilation =

These components are compiled regularly:

* WFP
* WD

The components you need to compile and place under src\original\

* PCProxy - DLL x32 (and x64 if provided)
* LSP\NonIFSLSP (or LSP\NonIFSLSP - DLL) x32 and x64
* LSP\InstallDLL x32 and x64
* KomodiaCertDLL x32 and (and x64 if provided), this is for SSL Digestor only

The components you need to compile and place under src\loader\

* Spoofer\PCProxy x32 (and x64 if provided)
* Spoofer\LSP (and x64 if provided)
* Spoofer\RegisterLSP x32 and x64
* Spoofer\KomodiaCertDLL x32 and (and x64 if provided), this is for SSL Digestor only

Run merge.bat and if exists merge64.bat, it will build all files under src\loader and those are your final binaries
</textarea><div class="templatesUsed"></div><p id="mw-returnto">Return to <a href="index.php/Komodia's_Redirector_Compile_Insturctions.html" title="Komodia's Redirector Compile Insturctions">Komodia's Redirector Compile Insturctions</a>.</p>
</div><div class="printfooter">
Retrieved from "<a href="index.php/Komodia's_Redirector_Compile_Insturctions.html">http://www.komodia.com/wiki/index.php/Komodia%27s_Redirector_Compile_Insturctions</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php/Komodia's_Redirector_Compile_Insturctions.html" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.komodia.com/wiki/index.php?title=Talk:Komodia%27s_Redirector_Compile_Insturctions&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource" class="selected"><a href="index.php@title=Komodia%2527s_Redirector_Compile_Insturctions&amp;action=edit.html" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="index.php@title=Komodia%2527s_Redirector_Compile_Insturctions&amp;action=history.html" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://www.komodia.com/wiki/index.php/User:46.165.222.245" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">46.165.222.245</a></li>
				<li id="pt-anontalk"><a href="http://www.komodia.com/wiki/index.php/User_talk:46.165.222.245" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
				<li id="pt-anonlogin"><a href="index.php@title=Special%253AUserLogin&amp;returnto=Komodia%2527s+Redirector+Compile+Insturctions&amp;returntoquery=action%253Dedit.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="index.php/Main_Page.html" style="background-image: url(http://www.komodia.com/images/logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="index.php/Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-Official-homepage"><a href="../index.php.html">Official homepage</a></li>
				<li id="n-recentchanges"><a href="index.php/Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.komodia.com/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Komodia [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index.php/Special%253AWhatLinksHere/Komodia's_Redirector_Compile_Insturctions.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index.php/Special%253ARecentChangesLinked/Komodia's_Redirector_Compile_Insturctions.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="index.php/Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="privacy"><a href="index.php/Komodia%253APrivacy_policy.html" title="Komodia:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="index.php/Komodia%253AAbout.html" title="Komodia:About">About Komodia</a></li>
		<li id="disclaimer"><a href="index.php/Komodia%253AGeneral_disclaimer.html" title="Komodia:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6898822-1");
pageTracker._trackPageview();
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.komodia.com/" : "http://piwik.komodia.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 6);
piwikTracker.setDocumentTitle("");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://piwik.komodia.com/piwik.php?idsite=6" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.182 secs. --></body></html>