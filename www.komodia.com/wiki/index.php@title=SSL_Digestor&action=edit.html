<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>View source for SSL Digestor - Komodia</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.4" />
<link rel="next" href="index.php/SSL_Digestor.html" />
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Komodia (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api.php@action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Komodia Atom feed" href="index.php@title=Special%253ARecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;%252A.css" />
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: komod_wikidb:resourceloader:filter:minify-css:7:dffa96a73b1be9b0dae7e17005fcc939 */</style>

<script src="load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"SSL_Digestor","wgTitle":"SSL Digestor","wgCurRevisionId":1386,"wgArticleId":57,"wgIsArticle":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"SSL_Digestor","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: komod_wikidb:resourceloader:filter:minify-js:7:c89fc005766e312c555f83b307d08d63 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-SSL_Digestor skin-monobook action-edit">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">View source for SSL Digestor</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From Komodia</div>
		<div id="contentSub">‚Üê <a href="index.php/SSL_Digestor.html" title="SSL Digestor">SSL Digestor</a></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php@title=SSL_Digestor&amp;action=edit.html#column-one">navigation</a>, <a href="index.php@title=SSL_Digestor&amp;action=edit.html#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text"><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="http://www.komodia.com/wiki/index.php?title=Komodia:Users&amp;action=edit&amp;redlink=1" class="new" title="Komodia:Users (page does not exist)">Users</a>.
</p>
</div>
<hr />
<p>You can view and copy the source of this page:
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">= What is the SSL Digestor =

The SSL Digestor is a module that is layered on top [[Komodia's Redirector]] and allows the programmer a transparent access to the decrypted SSL data, this is without raising an alert from the brower.

= Applications supported =

* The SSL Digestor supports the following browsers:

** Internet Explorer
** Safari
** Chrome
** Firefox
** Opera

* Chat software:

** The module supports Gmail and Facebook chat decoding.

* The SSL Digestor supports the following SSL enabled email clients:

** Outlook
** Outlook express
** Winmail
** Forte agent
** Becky! internet mail
** Mailwasher
** Pocomail
** Poppeeper

* The SSL Digestor supports the following SSL enabled applications:

** iTunes

* The SSL Digestor does not support the following SSL decrypting resisting applications:

** Dropbox
** Google drive
** Logmein
** AIM

= Applications not in the list =

The module may work with unlisted applications that use either the Windows or NSS certificate stores, but that's not officially supported.

= How does it work? =

The SSL Digestor is a modified [http://en.wikipedia.org/wiki/Man-in-the-middle_attack Man In The Middle attack], what it does is "talk" with the application on one side, and talking with the target server on the other, and the Redirector being the man in the middle, just as someone who gets a secret whispered in each ear, normally the browser/app would raise an alert because of the modified certificate, but the [[Komodia's Redirector]] installs a root CA certificate in advance which means the browser will not send an alert because the certificate created is legit from SSL point of view.

= CA Store =

A root certificate is installed in a certificate store, currently there are three supported store:

* Windows which affects: Internet Explorer, Chrome, Safari/iTunes (Apple software require an extra step to make it work), Outlook, Outlook express and Winmail.
* NSS which affects: Firefox and Thunderbird.
* Opera

Applications that manages their own store or applications that tries to verify the certificate will raise an alert when the certificate is replaced and will not work with the SSL Digestor (for example Dropbox)

= Cert creation =

The SSL Digestor tries to copy the certificate as best as possible, one field it can't copy is the generating entity which will be the company name the module is branded to, it will also copy fields that may cause the certificate verification to fail, because if the original site's certificate would fail, the module wants the same affect so it will not cause a security problem. Also the module tries to verify that the certificate is indeed signed by an approved signer, it will use the CA store of the browser used to verify that (for Internet Explorer the Windows store will be used, and for Firefox the NSS store will be used), if the certificate isn't legit, the created certificate will be created in a way it would raise an alert to protect the user.

= Cert validation =

When you receive the cert from the remote server the SDK will validate the cert with the store of the browser that created the connection, also in Windows 7 IE/Chrome the SDK will try to download root and intermediate certs in real time in order to validate the end cert.

= Limitations =

== Cert checking ==

Some applications are actively checking that they receive a certificate they expected to receive (they compare it with a binary copy inside the executable) and you will not be able to decrypt their data, those applications should be SSL excluded (known resisting applications are excluded by default), for example: Dropbox, Logmein ActiveX, also officially only the five browsers are supported.

== Non HTTPS SSL ==

SSL/TLS can be used in protocols that are not HTTPS, for example SMTPS and FTPS, which start the secure handshake after they send plaintext, the SSL digestor only supports SSL/TLS decrypting when it start at the first data transfer (such as HTTPS).

== Client side certificate ==

The SDK can't work with sites that require client side cert, what the SDK does is when a site requests client cert, the SDK excludes the entire domain, then the browser can "speak" with the site directly.

= Combining SSL Digestor with existing solutions =

Some clients have existing solutions that does not support SSL decrypting and want to use Komodia's module, these are the options to do the upgrade:

* Upgrade the entire product and use Komodia's SDK for both HTTP and HTTPS.
* Use Komodia's SDK just for port 443, and keep using the existing solution for all other ports, also the existing component must know how to co exist with Komodia's filtering components such as LSP or WFP, because some solutions are written (on purpose or because of bugs) to not work with other solutions.

= SSL decryption via proxy =

Some of Komodia's clients requested to have the ability to receive the decrypted inside their proxy so there's an optional module that does that. How it works:

* A connection is made to the Redirector, the SDK checks if it has the certificate for this IP/Port.
* If it does, it uses the one in cache, if not, it creates a direct connection (not via the proxy) just to get the certificate, once it gets it, it disconnects the session.
* The Redirector is using the cache it has to communicate with the browser, and it sends the decrypted data to the socks5 proxy of the client.
* The client's socks5 proxy uses regular SSL when it outputs the data to the original server (the proxy has to encrypt the outbound data)

= Alternative methods =

It's possible to use detour like functionality to intercept the SSL stream before it's encoded and after it's decrypted but there are limitations to this method:

# MS Detours costs 10,000$ at the day of writing this post.
# Opera will be almost impossible to detour as it's statically linked with a SSL library.
# DLL injection is required (if not using LSP), which will cause alerts from AV software.

The [http://www.komodia.com/sniffer/ Komodia's SSL Sniffer] is based upon detouring technique (using Komodia's proprietary code detour library), but we discontinued this technology.

== TLS SNI ==

[http://en.wikipedia.org/wiki/Server_Name_Indication TLS SNI] is used by the browser (when using TLS) to tell the server the name of the host it wants to use, this is needed for multi homed SSL sites.

Pros:

* No need to decrypt traffic.

Cons:

* Doesn't work with IE/Chrome on Windows XP.
* May not work with ActiveX or Java.
* Can only get the host and not the full URL.
* You can't modify the data, just block the connection.
* Data remains encrypted, this method is used only to extract the host.
</textarea><div class="templatesUsed"></div><p id="mw-returnto">Return to <a href="index.php/SSL_Digestor.html" title="SSL Digestor">SSL Digestor</a>.</p>
</div><div class="printfooter">
Retrieved from "<a href="index.php/SSL_Digestor.html">http://www.komodia.com/wiki/index.php/SSL_Digestor</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php/SSL_Digestor.html" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.komodia.com/wiki/index.php?title=Talk:SSL_Digestor&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource" class="selected"><a href="index.php@title=SSL_Digestor&amp;action=edit.html" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="index.php@title=SSL_Digestor&amp;action=history.html" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://www.komodia.com/wiki/index.php/User:46.165.222.245" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">46.165.222.245</a></li>
				<li id="pt-anontalk"><a href="http://www.komodia.com/wiki/index.php/User_talk:46.165.222.245" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
				<li id="pt-anonlogin"><a href="index.php@title=Special%253AUserLogin&amp;returnto=SSL+Digestor&amp;returntoquery=action%253Dedit.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="index.php/Main_Page.html" style="background-image: url(http://www.komodia.com/images/logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="index.php/Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-Official-homepage"><a href="../index.php.html">Official homepage</a></li>
				<li id="n-recentchanges"><a href="index.php/Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.komodia.com/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Komodia [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index.php/Special%253AWhatLinksHere/SSL_Digestor.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index.php/Special%253ARecentChangesLinked/SSL_Digestor.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="index.php/Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="privacy"><a href="index.php/Komodia%253APrivacy_policy.html" title="Komodia:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="index.php/Komodia%253AAbout.html" title="Komodia:About">About Komodia</a></li>
		<li id="disclaimer"><a href="index.php/Komodia%253AGeneral_disclaimer.html" title="Komodia:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6898822-1");
pageTracker._trackPageview();
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.komodia.com/" : "http://piwik.komodia.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 6);
piwikTracker.setDocumentTitle("");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://piwik.komodia.com/piwik.php?idsite=6" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.177 secs. --></body></html>